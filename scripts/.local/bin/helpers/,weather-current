#!/bin/sh

set -e

[ "$1" == 'fetch' ] &&
	curl 'http://wttr.in/Aloor?format=+%C|+%t|+%f|+%h|+%p|+%w' >/tmp/weather-current &&
	exit 0

[ -f /tmp/weather-current ] ||
	curl -s 'http://wttr.in/Aloor?format=+%C|+%t|+%f|+%h|+%p|+%w' >/tmp/weather-current
sed 's/  / /g;s/| /|/g;s/^ //' /tmp/weather-current |
	awk -F'|' '{print $1,$2"("$3") with",$4,"humidity and",$6,"speed winds"}'
